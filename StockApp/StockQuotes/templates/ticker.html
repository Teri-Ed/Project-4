{% extends 'base.html' %}
{% block content %}

<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Project-4 Homepage</title>  
    </head>
    <body>
        <div class="container">
            <div class="row">
              <div class="col">
                {% if ticker %}
                    {{ ticker }}
                {% endif %}
    
                {% if api %}
                    {% if api == "Error..." %}
                        There was a problem with your ticker symbol, 
                        please try again...
                    {% else %}
                        <h1>{{ api.companyName }}</h1>
                        <br/>
                        {% load humanize %}
                        Price: ${{ api.latestPrice|intcomma }}<br/>
                        Previous Close: ${{ api.previousClose|intcomma }}<br/>
                        Market Cap: ${{ api.marketCap|intcomma }}<br/>
                        YTD Change: {{ api.ytdChange }}<br/>
                        52 Week High: ${{ api.week52High|intcomma }}<br/>
                        52 Week Low: ${{ api.week52Low|intcomma }}<br/>
                        <br/>
        
                    {% endif %}
                
                {% else %}
        
                {% endif %}


              </div>
              <div class="col">
                <h1>Buy Stock</h1>
                <br/>
                <div class = "form-group">
                    <form action = "{%url 'buy_stock' %}"  method = "POST">
                        {% csrf_token %}
                        {{ form.as_p }}
        
                        <button type="submit" class="btn btn-success">Buy Stock</button>
                        <button type="submit" class="btn btn-danger">Sell Stock</button>
                    </form>
                </div>
                  <br/>
                  <br/>
                <div class = "container">
                    <table class="table table-striped table-bordered table-hover">
                        <thead class="thead-dark">
                        <tr>
                            <th scope="col">Date Purchased</th>
                            <th scope="col">Company Name</th>
                            <th scope="col">Stock Price</th>
                            <th scope="col">Shares Purchased</th>
                            <th scope="col">Total Value</th>
                        </tr>
                        </thead>
                        <tbody>
                            {% for item in stocks %}
                            <tr>
                                    <th scope="row">{{ item.created }}</th>
                                    <td>{{ item.name }}</td>
                                    <td>{{ item.price }}</td>
                                    <td>{{ item.quantity }}</td>
                                    <td>{{ item.total_value }}</td>
                            </tr>
                                {% endfor %}
        
                        </tbody>
                    </table>
                    <h1></h1>
                </div>
              </div>
            </div>
          </div>


        {% comment %}

        {% for key, value in api.items %}
                    {{ key }} : {{ value }}
                    <br/>
        {% endfor %}
        {% endcomment %}


        </body>
    </body>

{% endblock %}